# 破壊的変更: type("int")からtype<int>()への移行

## 変更日
2025-09-10

## 承認ID
approval_1757463508888_4clg1nmx8

## 変更の概要
引数の型指定方法を文字列ベース`type("int")`からテンプレートメソッド`type<int>()`に変更しました。この変更により、型安全性が向上し、コンパイル時にタイポや型の不一致を検出できるようになります。

## 詳細説明と根本原因

### 問題点
1. **型安全性の欠如**: `type("int")`では"itn"のようなタイポがコンパイル時に検出されない
2. **Python互換性の欠如**: Pythonのargparseは`type=int`のように型オブジェクトを直接渡す
3. **拡張性の制限**: カスタム型の追加が文字列マッピングに依存

### 解決策
C++のテンプレート機能を活用し、`type<int>()`形式でコンパイル時型チェックを実現

## 修正/変更内容

### 1. 要件定義書 (requirements.md)
- 要件6: 型変換と検証
  - 変更前: `WHEN typeでintを指定`
  - 変更後: `WHEN type<int>()テンプレートメソッドを指定`
  - カスタム型のサポートを追加

### 2. 設計書 (design.md)
- Argumentインターフェース
  - 変更前: `set_type(converter)`
  - 変更後: `type<T>()` テンプレートメソッド
- ArgumentDefinition構造体
  - 変更前: `std::string type_name`
  - 変更後: `std::type_info const* type_info`
- 型安全な型指定セクションを追加

### 3. タスク文書 (tasks.md)
- タスク4: 型変換機能の実装
  - テンプレートメソッド実装を明記
  - テストケースを更新

## 影響範囲

### 破壊的変更
- 既存コードの`type("int")`は動作しなくなる
- 以下の形式への変更が必要：
  ```cpp
  // 変更前
  parser.add_argument("--count").type("int");
  
  // 変更後
  parser.add_argument("--count").type<int>();
  ```

### 対象となる型
- `type<int>()` - 整数型
- `type<float>()` - 単精度浮動小数点
- `type<double>()` - 倍精度浮動小数点
- `type<bool>()` - 真偽値
- `type<std::string>()` - 文字列
- カスタム型の特殊化も可能

## 利点
1. **コンパイル時エラー検出**: タイポや型の不一致を早期発見
2. **型安全性**: 明示的な型指定により意図が明確
3. **C++らしいAPI**: テンプレートベースの設計
4. **Python互換性の向上**: `type=int`により近い形式

## テスト要件
- `type<int>()`等の各型のテスト追加が必要
- 型変換エラーのテストケース
- カスタム型のテンプレート特殊化テスト

## 移行ガイド
READMEの使用例は既に`type<int>()`形式で記載されているため、実装を仕様に合わせる形での変更となります。

## 関連Issue
- GitHub Issue #3: type<int>()テンプレートメソッドのテスト未実装

## レビュー承認
- 承認者: ユーザー（ダッシュボード経由）
- 承認日時: 2025-09-10T00:20:06.146Z
- 承認メッセージ: ダッシュボードから承認